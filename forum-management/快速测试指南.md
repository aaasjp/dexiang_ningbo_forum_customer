# 操作记录功能 - 快速测试指南

## 🚀 快速开始

### 1. 启动项目
```bash
cd /Users/ailabuser2-1/Documents/mywork/forum-management
npm run dev
```

### 2. 访问内容管理页面
在浏览器中打开：
```
http://localhost:5173/content
```
或点击左侧导航菜单的 **"内容管理"**

### 3. 打开操作记录弹框
点击页面右上角的 **"操作记录"** 按钮

## ✅ 功能测试清单

### 基础功能
- [ ] 点击"操作记录"按钮，弹框正常打开
- [ ] 弹框标题显示为"操作记录"
- [ ] 弹框内有搜索框和搜索按钮
- [ ] 表格正常显示，包含7个列
- [ ] 底部显示分页器

### 数据加载
- [ ] 弹框打开时自动加载数据
- [ ] 显示加载状态（loading 动画）
- [ ] 数据加载成功后显示在表格中
- [ ] 显示正确的总条数

### 表格显示
- [ ] 序号：从1开始递增
- [ ] 用户工号：显示正确
- [ ] 用户姓名：显示正确
- [ ] 操作类型：显示中文（如"删除问题"）
- [ ] 操作内容：完整显示，超长时省略
- [ ] IP地址：显示正确
- [ ] 操作时间：格式为 YYYY-MM-DD HH:mm:ss

### 搜索功能
- [ ] 在搜索框输入用户工号
- [ ] 点击搜索按钮，数据正确筛选
- [ ] 按 Enter 键也能触发搜索
- [ ] 点击清除按钮，清空搜索内容
- [ ] 清空后再次搜索，显示全部数据

### 分页功能
- [ ] 点击下一页，加载第2页数据
- [ ] 序号正确递增（第2页从11开始，假设每页10条）
- [ ] 点击上一页，返回第1页
- [ ] 点击具体页码，跳转到对应页
- [ ] 切换每页显示数量（10/20/50/100）
- [ ] 切换后，数据正确显示

### 交互体验
- [ ] 点击弹框外部区域，弹框关闭
- [ ] 点击右上角关闭按钮，弹框关闭
- [ ] 关闭弹框后，搜索条件被重置
- [ ] 再次打开弹框，显示默认数据（第1页）

## 🐛 常见问题

### 问题1：点击按钮无反应
**检查**：
1. 打开开发者工具（F12）
2. 查看 Console 是否有错误
3. 刷新浏览器（Ctrl/Cmd + Shift + R）

### 问题2：弹框打开但没有数据
**检查**：
1. 切换到 Network 标签页
2. 查看是否有请求到 `/api/admin/logs/list`
3. 检查请求状态码（应该是200）
4. 查看响应数据

**可能原因**：
- 后端服务未启动
- 后端数据库中没有数据
- 请求 URL 不正确

### 问题3：搜索功能不工作
**检查**：
1. 确认输入的工号在数据库中存在
2. 查看 Network 请求参数中是否包含 `user_code`
3. 查看响应数据是否正确筛选

### 问题4：CORS 跨域错误
**解决**：
检查 `src/utils/request.js` 中的 `baseURL` 配置是否正确

## 🧪 使用测试页面

如果遇到问题，可以使用独立的测试页面：

1. 访问：`http://localhost:5173/logs-test`
2. 点击"测试 API 调用"按钮
3. 查看响应结果

这可以帮助判断问题是在组件层还是 API 层。

## 📊 预期结果示例

### 正常的 API 响应
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "items": [
      {
        "log_id": 1,
        "user_code": "001",
        "user_name": "张三",
        "operation_type": "question_delete",
        "content": "删除问题：测试问题标题",
        "ip_address": "192.168.1.1",
        "create_time": "2024-01-01T10:00:00"
      }
    ],
    "total": 100
  }
}
```

### 正常的控制台输出
打开弹框后，Network 标签页应该看到：
- Request URL: `http://10.129.114.106:8000/api/admin/logs/list?page=1&page_size=10`
- Method: GET
- Status: 200
- Response: 包含 items 和 total 的 JSON 数据

## 📞 需要帮助？

如果测试中遇到问题：
1. 查看 `故障排查指南.md` 获取详细排查步骤
2. 查看 `操作记录功能修正说明.md` 了解实现细节
3. 检查浏览器控制台的完整错误信息

## ✨ 成功标志

当以下所有功能都正常工作时，说明集成成功：
- ✅ 点击按钮打开弹框
- ✅ 自动加载操作记录数据
- ✅ 搜索功能正常
- ✅ 分页功能正常
- ✅ 操作类型显示中文
- ✅ 时间格式正确
- ✅ 关闭弹框后可以重新打开

---

**祝测试顺利！** 🎉



